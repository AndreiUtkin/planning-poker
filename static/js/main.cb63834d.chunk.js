(window["webpackJsonpplanning-poker"]=window["webpackJsonpplanning-poker"]||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),i=n.n(o);n(92),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=n(48),l=n(20),s=Object(a.createContext)(null),u=n(10),m=r.a.createContext(null),p=n(17),d=n.n(p),E=n(24),f=n(35),b=n(31),g=n.n(b),O=(n(94),n(96),{apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_API_KEY,authDomain:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_AUTH_DOMAIN,databaseURL:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_DATABASE_URL,projectId:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_PROJECT_ID,storageBucket:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_STORAGE_BUCKET,messagingSenderId:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:Object({NODE_ENV:"production",PUBLIC_URL:"/planning-poker"}).REACT_APP_FIREBASE_APP_ID}),h=function e(){var t=this;Object(f.a)(this,e),this.doSignIn=Object(E.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new g.a.auth.GithubAuthProvider,e.next=3,t.auth.signInWithPopup(n);case 3:case"end":return e.stop()}}),e)}))),this.doSignOut=function(){return t.auth.signOut()},this.sessions=function(){return t.firestore().collection("sessions")},this.session=function(e){return t.sessions().doc(e)},g.a.initializeApp(O),this.auth=g.a.auth(),this.firestore=g.a.firestore},v=n(23);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var k=function(e){var t=Object(a.useContext)(m),n=Object(a.useState)(!1),r=Object(u.a)(n,2),o=r[0],i=r[1],c=Object(a.useState)(!0),l=Object(u.a)(c,2),s=l[0],p=l[1],d=Object(a.useState)([]),E=Object(u.a)(d,2),f=E[0],b=E[1];return Object(a.useEffect)((function(){var n=t.firestore().collection(e).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id},e.data()))})),p(!1),b(t)}),(function(e){p(!1),i(e)}));return function(){return n()}}),[t,e]),{collection:f,error:o,isLoading:s}};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var P=function(e){var t=Object(a.useContext)(m),n=Object(a.useState)(!1),r=Object(u.a)(n,2),o=r[0],i=r[1],c=Object(a.useState)(!0),l=Object(u.a)(c,2),s=l[0],p=l[1],d=Object(a.useState)(null),E=Object(u.a)(d,2),f=E[0],b=E[1];return Object(a.useEffect)((function(){var n=t.firestore().doc(e).onSnapshot((function(e){p(!1),b(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id},e.data()))}),(function(e){p(!1),i(e)}));return function(){return n()}}),[t,e]),{error:o,isLoading:s,doc:f}},w=h,C=function(e){return e.match(/^([^@]*)@/)[1].replace(/\./g," ")},_=function(){var e=Object(a.useContext)(m),t=Object(a.useState)((function(){var t=e.auth.currentUser;return{initializing:!t,user:t}})),n=Object(u.a)(t,2),r=n[0],o=n[1];function i(e){e&&(e.planningPokerUsername=C(e.email)),o({initializing:!1,user:e})}return Object(a.useEffect)((function(){var t=e.auth.onAuthStateChanged(i);return function(){return t()}}),[e]),r},S="/home",A=function(e){return"/session/".concat(e)},x=function(e,t){var n=Object(a.useContext)(m);Object(a.useEffect)((function(){var a=n.auth.onAuthStateChanged((function(n){e(n)||t.push("/")}));return function(){return a()}}),[n,e])},I={userIsSignedIn:function(e){return!!e}},U=n(127),R=n(126),D=n(123),L=n(124),B=n(116),N=Object(l.e)((function(e){var t=e.title,n=e.match,a=e.history,o=e.children,i=n.path!==S&&"/"!==n.path;return r.a.createElement(D.a,{full:!0},r.a.createElement(L.a,{fill:!0,align:"start",background:"light-4",pad:"small"},r.a.createElement(L.a,{direction:"row"},i&&r.a.createElement(L.a,{justify:"center",pad:"small"},r.a.createElement(R.a,{onClick:function(){return a.push(S)},icon:r.a.createElement(B.a,{color:"accent-2"})})),r.a.createElement(U.a,null,t)),o))})),T=function(){var e=Object(E.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.doSignIn();case 2:n.push(S);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(e){e.push(S)},F=function(e){var t=e.history,n=Object(a.useContext)(s),o=Object(a.useContext)(m);return r.a.createElement(N,null,r.a.createElement(U.a,null,"Welcome to planning poker"," ",n?n.planningPokerUsername:""),n&&r.a.createElement(R.a,{primary:!0,label:"Start",onClick:z.bind(void 0,t)}),!n&&r.a.createElement(R.a,{primary:!0,label:"Sign in",onClick:T.bind(void 0,o,t)}))},V=n(128),H=n(129),J=n(117),W=n(118),Y=[1,2,5,8,13];var G=function(e){var t=e.session,n=Object(a.useContext)(m),o=Object(a.useContext)(s),i=t.users&&t.users.includes(o.planningPokerUsername),c=t.votes&&t.votes[o.planningPokerUsername];return r.a.createElement(L.a,{align:"start",gap:"small",background:"neutral-3",pad:"small"},r.a.createElement(U.a,{level:"2",margin:"none",size:"small"},"Your vote"),i&&!c&&r.a.createElement(V.a,null,"You have not voted on this issue yet. Please do so by clicking one of the estimates below"),i&&c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(L.a,{align:"center"},r.a.createElement(H.a,{color:"accent-1",size:"80px",weight:"bold"},c)),r.a.createElement(V.a,null,"You may change your vote by clicking another estimate below")),i&&r.a.createElement(L.a,{gap:"xxsmall",direction:"row"},Y.map((function(e){return r.a.createElement(R.a,{key:"estimate_".concat(e),label:e,disabled:c===e,onClick:function(){return a=e,void n.session(t.id).update(Object(v.a)({},"votes.".concat(o.planningPokerUsername),a));var a}})}))),i?r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{size:"small"},"To remove your vote and leave the session click below"),r.a.createElement(R.a,{color:"accent-3",label:"Leave",onClick:function(){n.session(t.id).update(Object(v.a)({users:n.firestore.FieldValue.arrayRemove(o.planningPokerUsername)},"votes.".concat(o.planningPokerUsername),n.firestore.FieldValue.delete()))},icon:r.a.createElement(J.a,null)})):r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,null,"You need to join the session before you may cast a vote. Join by clicking below"),r.a.createElement(R.a,{primary:!0,label:"Join",onClick:function(){n.session(t.id).update({users:n.firestore.FieldValue.arrayUnion(o.planningPokerUsername)})},icon:r.a.createElement(W.a,null)})))},K=n(130);var M=function(e){var t=e.session,n=Object(a.useContext)(m),o=Object(a.useContext)(s);return r.a.createElement(L.a,{align:"start",gap:"small",background:"neutral-4",pad:"small"},r.a.createElement(U.a,{level:"2",margin:"none",size:"small"},"Results"),r.a.createElement(V.a,null,"Voting results will appear below for each user"),r.a.createElement(K.a,{checked:t.reveal,label:"Reveal results",onChange:function(e){var a=e.target.checked;n.session(t.id).update({reveal:a})}}),r.a.createElement(L.a,{direction:"row",justify:"center",gap:"small"},t.users&&t.users.map((function(e){var n=function(e){return t.votes&&t.votes[e]}(e),a=e===o.planningPokerUsername?{color:"accent-3",size:"xsmall"}:{size:"xsmall"};return r.a.createElement(L.a,{key:"session_user_".concat(e),direction:"row",border:a},r.a.createElement(L.a,{pad:"xsmall"},r.a.createElement(H.a,{size:"large"},e)),n&&r.a.createElement(L.a,{pad:"xxsmall",justify:"center",width:"xxsmall",align:"center"},t.reveal?r.a.createElement(H.a,{size:"large",weight:"bold"},n):r.a.createElement(H.a,{size:"large"},r.a.createElement("span",{role:"img","aria-label":"waiting"},"\ud83e\udd10"))))}))))},$=function(e){var t=e.history,n=e.match.params.id;x(I.userIsSignedIn,t);var a=P("sessions/".concat(n)),o=a.doc,i=a.isLoading,c=a.error,l=o?o.title:i?"Loading...":c?"Error":"";return r.a.createElement(N,{title:l},o&&r.a.createElement(L.a,{fill:"horizontal",direction:"row",gap:"small"},r.a.createElement(L.a,{width:"medium"},r.a.createElement(G,{session:o})),r.a.createElement(L.a,{flex:"grow"},r.a.createElement(M,{session:o}))))},q=n(131),Q=n(120),X=n(121),Z=n(122),ee=n(81),te=n(82),ne=n(84),ae=n(37),re=n(83),oe=n(125),ie=function(e){function t(){return Object(f.a)(this,t),Object(ne.a)(this,Object(ae.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(te.a)(t,[{key:"componentDidMount",value:function(){this.startAutoHideTimeout()}},{key:"componentWillUnmount",value:function(){this.timeoutAutoHide&&clearTimeout(this.timeoutAutoHide)}},{key:"startAutoHideTimeout",value:function(){var e=this.props,t=e.duration,n=e.onClose;t&&(this.timeoutAutoHide=setTimeout((function(){n()}),1e3*t))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.modal,a=e.position,o=e.full,i=Object(ee.a)(e,["children","modal","position","full"]);return r.a.createElement(oe.a,Object.assign({position:a||"top",full:o,modal:n,margin:"none",responsive:!0,plain:!n},i),t)}}]),t}(a.Component),ce=function(e){var t=e.onClose,n=Object(a.useState)(""),o=Object(u.a)(n,2),i=o[0],c=o[1],l=Object(a.useContext)(m),p=Object(a.useContext)(s);function f(){return(f=Object(E.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.sessions().add({title:i,createdBy:p.planningPokerUsername,dateCreated:new Date});case 2:t();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(ie,{position:"center",modal:!0},r.a.createElement(L.a,{align:"center"},r.a.createElement(L.a,{width:"medium",pad:"small",round:!1},r.a.createElement(U.a,{level:"4",margin:"small"},"Please enter a title"),r.a.createElement(Z.a,{autoFocus:!0,placeholder:"type here",value:i,onChange:function(e){return c(e.target.value)}})),r.a.createElement(L.a,{width:"medium",margin:"none",direction:"row"},r.a.createElement(L.a,{basis:"1/2"},r.a.createElement(R.a,{plain:!0,color:"dark-1",onClick:function(){return f.apply(this,arguments)}},r.a.createElement(L.a,{pad:"small",align:"center",background:"status-ok"},"Ok"))),r.a.createElement(L.a,{basis:"1/2"},r.a.createElement(R.a,{plain:!0,color:"dark-1",onClick:t},r.a.createElement(L.a,{pad:"small",align:"center",background:"status-error"},"Cancel"))))))},le=function(e){var t=e.onNavigateToSession,n=Object(a.useState)(!1),o=Object(u.a)(n,2),i=o[0],c=o[1],l=k("sessions"),s=l.collection,m=l.error;return l.isLoading?r.a.createElement(U.a,{level:"4"},"Loading..."):m?r.a.createElement(U.a,{level:"4"},"Error loading sessions"):r.a.createElement(q.a,{align:"start",gap:"small"},r.a.createElement(L.a,{align:"start"},r.a.createElement(R.a,{icon:r.a.createElement(Q.a,null),label:"Create New Session",onClick:function(){return c(!0)},color:"accent-4",primary:!0})),r.a.createElement(L.a,{gap:"small",direction:"row-responsive"},s.map((function(e){return r.a.createElement(L.a,{key:"sessionlist_".concat(e.id),background:"neutral-2",pad:"small",onClick:function(){return t(e.id)}},r.a.createElement(U.a,{level:"3",margin:"none"},e.title),r.a.createElement(H.a,{size:"xsmall"},"Created by ",e.createdBy," ",e.dateCreated&&"".concat(Object(X.a)(e.dateCreated.toDate(),new Date)," ago")))}))),i&&r.a.createElement(ce,{onClose:function(){return c(!1)}}))},se=function(e){var t=e.history;return x(I.userIsSignedIn,t),r.a.createElement(N,{title:"All Sessions"},r.a.createElement(le,{onNavigateToSession:function(e){t.push(A(e))}}))},ue=function(){var e=_();return r.a.createElement(s.Provider,{value:e.user},r.a.createElement(c.a,{basename:"/"},r.a.createElement(l.a,{exact:!0,path:"/",component:F}),r.a.createElement(l.a,{path:S,component:se}),r.a.createElement(l.a,{path:"/session/:id",component:$})))};i.a.render(r.a.createElement(m.Provider,{value:new w},r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},87:function(e,t,n){e.exports=n(108)},92:function(e,t,n){}},[[87,1,2]]]);
//# sourceMappingURL=main.cb63834d.chunk.js.map
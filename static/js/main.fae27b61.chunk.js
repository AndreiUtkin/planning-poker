(window["webpackJsonpplanning-poker"]=window["webpackJsonpplanning-poker"]||[]).push([[0],{109:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(16),c=n.n(o);n(93),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(49),s=n(21),l=Object(a.createContext)(null),u=n(10),m=r.a.createContext(null),p=n(18),d=n.n(p),f=n(24),b=n(35),g=n(31),h=n.n(g),v=(n(95),n(97),{apiKey:"AIzaSyDF1eF-t1aZ-GL843kh__tzckXTMJuZe0k",authDomain:"planningpokertest-eaa38.firebaseapp.com",databaseURL:"https://planningpokertest-eaa38.firebaseio.com",projectId:"planningpokertest-eaa38",storageBucket:"planningpokertest-eaa38.appspot.com",messagingSenderId:"174221390038",appId:"1:174221390038:web:bc91675229150b140fd977"}),O=function e(){var t=this;Object(b.a)(this,e),this.doSignIn=Object(f.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new h.a.auth.GithubAuthProvider,e.next=3,t.auth.signInWithPopup(n);case 3:case"end":return e.stop()}}),e)}))),this.doSignOut=function(){return t.auth.signOut()},this.sessions=function(){return t.firestore().collection("sessions")},this.session=function(e){return t.sessions().doc(e)},h.a.initializeApp(v),this.auth=h.a.auth(),this.firestore=h.a.firestore},E=n(23);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var k=function(e){var t=Object(a.useContext)(m),n=Object(a.useState)(!1),r=Object(u.a)(n,2),o=r[0],c=r[1],i=Object(a.useState)(!0),s=Object(u.a)(i,2),l=s[0],p=s[1],d=Object(a.useState)([]),f=Object(u.a)(d,2),b=f[0],g=f[1];return Object(a.useEffect)((function(){var n=t.firestore().collection(e).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach((function(t){Object(E.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id},e.data()))})),p(!1),g(t)}),(function(e){p(!1),c(e)}));return function(){return n()}}),[t,e]),{collection:b,error:o,isLoading:l}};function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var w=function(e){var t=Object(a.useContext)(m),n=Object(a.useState)(!1),r=Object(u.a)(n,2),o=r[0],c=r[1],i=Object(a.useState)(!0),s=Object(u.a)(i,2),l=s[0],p=s[1],d=Object(a.useState)(null),f=Object(u.a)(d,2),b=f[0],g=f[1];return Object(a.useEffect)((function(){var n=t.firestore().doc(e).onSnapshot((function(e){p(!1),g(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach((function(t){Object(E.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:e.id},e.data()))}),(function(e){p(!1),c(e)}));return function(){return n()}}),[t,e]),{error:o,isLoading:l,doc:b}},C=O,S=function(e){return e.match(/^([^@]*)@/)[1]},x=function(){var e=Object(a.useContext)(m),t=Object(a.useState)((function(){var t=e.auth.currentUser;return{initializing:!t,user:t}})),n=Object(u.a)(t,2),r=n[0],o=n[1];function c(e){e&&(e.planningPokerUsername=S(e.email)),o({initializing:!1,user:e})}return Object(a.useEffect)((function(){var t=e.auth.onAuthStateChanged(c);return function(){return t()}}),[e]),r},P="/home",D=function(e){return"/session/".concat(e)},I=function(e,t){var n=Object(a.useContext)(m);Object(a.useEffect)((function(){var a=n.auth.onAuthStateChanged((function(n){e(n)||t.push("/")}));return function(){return a()}}),[n,e])},A={userIsSignedIn:function(e){return!!e}},U=n(131),z=n(130),L=n(124),T=n(126),B=n(116),F=Object(s.e)((function(e){var t=e.title,n=e.match,a=e.history,o=e.children,c=n.path!==P&&"/"!==n.path;return r.a.createElement(L.a,{full:!0},r.a.createElement(T.a,{fill:!0,align:"start",background:"light-4",pad:"small"},r.a.createElement(T.a,{direction:"row"},c&&r.a.createElement(T.a,{justify:"center",pad:"small"},r.a.createElement(z.a,{onClick:function(){return a.push(P)},icon:r.a.createElement(B.a,{color:"accent-2"})})),r.a.createElement(U.a,null,t)),o))})),R=function(){var e=Object(f.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.doSignIn();case 2:n.push(P);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),_=function(e){e.push(P)},H=function(e){var t=e.history,n=Object(a.useContext)(l),o=Object(a.useContext)(m);return r.a.createElement(F,null,r.a.createElement(U.a,null,"Welcome to planning poker ",n?n.email:""),n&&r.a.createElement(z.a,{primary:!0,label:"Start",onClick:_.bind(void 0,t)}),!n&&r.a.createElement(z.a,{primary:!0,label:"Sign in",onClick:R.bind(void 0,o,t)}))},W=n(129),J=n(122);var N=function(e){var t=e.session;return r.a.createElement(W.a,{size:"small"},"Created by ",t.createdBy," ",t.dateCreated&&"".concat(Object(J.a)(t.dateCreated.toDate(),new Date)," ago"))},V=n(117),G=n(118),M=[1,2,5,8,13];var Z=function(e){var t=e.session,n=Object(a.useContext)(m),o=Object(a.useContext)(l),c=t.users&&t.users.includes(o.planningPokerUsername),i=t.votes&&t.votes[o.planningPokerUsername];return r.a.createElement(T.a,{align:"start",gap:"small",background:"neutral-3",pad:"small"},r.a.createElement(U.a,{level:"2",margin:"none",size:"small"},"Your vote"),c&&r.a.createElement(T.a,{gap:"xxsmall",direction:"row"},M.map((function(e){return r.a.createElement(z.a,{key:"estimate_".concat(e),label:e,disabled:i===e,onClick:function(){return a=e,void n.session(t.id).update(Object(E.a)({},"votes.".concat(o.planningPokerUsername),a));var a}})}))),c?r.a.createElement(z.a,{color:"accent-3",label:"Leave session",onClick:function(){n.session(t.id).update(Object(E.a)({users:n.firestore.FieldValue.arrayRemove(o.planningPokerUsername)},"votes.".concat(o.planningPokerUsername),n.firestore.FieldValue.delete()))},icon:r.a.createElement(V.a,null)}):r.a.createElement(z.a,{primary:!0,label:"Join session",onClick:function(){n.session(t.id).update({users:n.firestore.FieldValue.arrayUnion(o.planningPokerUsername)})},icon:r.a.createElement(G.a,null)}))},K=n(128),X=n(119);var Y=function(e){var t=e.session,n=Object(a.useContext)(m),o=Object(a.useContext)(l);return r.a.createElement(T.a,{align:"start",gap:"small",background:"neutral-2",pad:"small"},r.a.createElement(U.a,{level:"2",margin:"none",size:"small"},"Results"),r.a.createElement(W.a,null,"Results for each user"),r.a.createElement(K.a,{checked:t.reveal,label:"Reveal results",onChange:function(e){var a=e.target.checked;n.session(t.id).update({reveal:a})}}),r.a.createElement(T.a,{direction:"row",justify:"center",gap:"small"},t.users&&t.users.map((function(e){var n=function(e){return t.votes&&t.votes[e]}(e);return r.a.createElement(T.a,{key:"session_user_".concat(e),direction:"row",border:!0},r.a.createElement(T.a,{pad:"xsmall",background:e===o.planningPokerUsername?"accent-1":"accent-4"},r.a.createElement(W.a,{size:"large"},e)),n&&r.a.createElement(T.a,{pad:"xxsmall",justify:"center",width:"xxsmall",align:"center"},t.reveal?r.a.createElement(W.a,{size:"large",weight:"bold"},n):r.a.createElement(X.a,null)))}))))},$=function(e){var t=e.history,n=e.match.params.id;I(A.userIsSignedIn,t);var a=w("sessions/".concat(n)),o=a.doc,c=a.isLoading,i=a.error,s=o?o.title:c?"Loading...":i?"Error":"";return r.a.createElement(F,{title:s},o&&r.a.createElement(T.a,{gap:"small"},r.a.createElement(N,{session:o}),r.a.createElement(T.a,{direction:"row",gap:"small"},r.a.createElement(Z,{session:o}),r.a.createElement(Y,{session:o}))))},q=n(127),Q=n(121),ee=n(123),te=n(81),ne=n(82),ae=n(84),re=n(37),oe=n(83),ce=n(125),ie=function(e){function t(){return Object(b.a)(this,t),Object(ae.a)(this,Object(re.a)(t).apply(this,arguments))}return Object(oe.a)(t,e),Object(ne.a)(t,[{key:"componentDidMount",value:function(){this.startAutoHideTimeout()}},{key:"componentWillUnmount",value:function(){this.timeoutAutoHide&&clearTimeout(this.timeoutAutoHide)}},{key:"startAutoHideTimeout",value:function(){var e=this.props,t=e.duration,n=e.onClose;t&&(this.timeoutAutoHide=setTimeout((function(){n()}),1e3*t))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.modal,a=e.position,o=e.full,c=Object(te.a)(e,["children","modal","position","full"]);return r.a.createElement(ce.a,Object.assign({position:a||"top",full:o,modal:n,margin:"none",responsive:!0,plain:!n},c),t)}}]),t}(a.Component),se=function(e){var t=e.onClose,n=Object(a.useState)(""),o=Object(u.a)(n,2),c=o[0],i=o[1],s=Object(a.useContext)(m),p=Object(a.useContext)(l);function b(){return(b=Object(f.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.sessions().add({title:c,createdBy:p.email,dateCreated:new Date});case 2:t();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(ie,{position:"center",modal:!0},r.a.createElement(T.a,{align:"center"},r.a.createElement(T.a,{width:"medium",pad:"small",round:!1},r.a.createElement(U.a,{level:"4",margin:"small"},"Please enter a title"),r.a.createElement(ee.a,{autoFocus:!0,placeholder:"type here",value:c,onChange:function(e){return i(e.target.value)}})),r.a.createElement(T.a,{width:"medium",margin:"none",direction:"row"},r.a.createElement(T.a,{basis:"1/2"},r.a.createElement(z.a,{plain:!0,color:"dark-1",onClick:function(){return b.apply(this,arguments)}},r.a.createElement(T.a,{pad:"small",align:"center",background:"status-ok"},"Accept"))),r.a.createElement(T.a,{basis:"1/2"},r.a.createElement(z.a,{plain:!0,color:"dark-1",onClick:t},r.a.createElement(T.a,{pad:"small",align:"center",background:"status-error"},"Reject"))))))},le=function(e){var t=e.onNavigateToSession,n=Object(a.useState)(!1),o=Object(u.a)(n,2),c=o[0],i=o[1],s=k("sessions"),l=s.collection,m=s.error;return s.isLoading?r.a.createElement(U.a,{level:"4"},"Loading..."):m?r.a.createElement(U.a,{level:"4"},"Error loading sessions"):r.a.createElement(q.a,{align:"start",gap:"small"},r.a.createElement(T.a,{align:"start"},r.a.createElement(z.a,{icon:r.a.createElement(Q.a,null),label:"Create New Session",onClick:function(){return i(!0)},color:"accent-4",primary:!0})),r.a.createElement(T.a,{gap:"small",direction:"row-responsive"},l.map((function(e){return r.a.createElement(T.a,{key:"sessionlist_".concat(e.id),background:"neutral-2",pad:"small",onClick:function(){return t(e.id)}},r.a.createElement(U.a,{level:"5",margin:"small"},e.title),r.a.createElement(W.a,{size:"xsmall"},"Created by ",e.createdBy," ",e.dateCreated&&"".concat(Object(J.a)(e.dateCreated.toDate(),new Date)," ago")))}))),c&&r.a.createElement(se,{onClose:function(){return i(!1)}}))},ue=function(e){var t=e.history;return I(A.userIsSignedIn,t),r.a.createElement(F,{title:"All Sessions"},r.a.createElement(le,{onNavigateToSession:function(e){t.push(D(e))}}))},me=function(){var e=x();return r.a.createElement(l.Provider,{value:e.user},r.a.createElement(i.a,{basename:"/"},r.a.createElement(s.a,{exact:!0,path:"/",component:H}),r.a.createElement(s.a,{path:P,component:ue}),r.a.createElement(s.a,{path:"/session/:id",component:$})))};c.a.render(r.a.createElement(m.Provider,{value:new C},r.a.createElement(me,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},88:function(e,t,n){e.exports=n(109)},93:function(e,t,n){}},[[88,1,2]]]);
//# sourceMappingURL=main.fae27b61.chunk.js.map
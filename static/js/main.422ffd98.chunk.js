(window["webpackJsonpplanning-poker"]=window["webpackJsonpplanning-poker"]||[]).push([[0],{109:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(16),c=a.n(o);a(93),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(49),s=a(21),l=Object(n.createContext)(null),u=a(10),m=r.a.createContext(null),d=a(18),p=a.n(d),f=a(24),b=a(35),E=a(31),g=a.n(E),h=(a(95),a(97),{apiKey:"__REPLACE__",authDomain:"__REPLACE__",databaseURL:"__REPLACE__",projectId:"__REPLACE__",storageBucket:"__REPLACE__",messagingSenderId:"__REPLACE__",appId:"__REPLACE__"}),v=function e(){var t=this;Object(b.a)(this,e),this.doSignIn=Object(f.a)(p.a.mark((function e(){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new g.a.auth.GoogleAuthProvider,e.next=3,t.auth.signInWithPopup(a);case 3:case"end":return e.stop()}}),e)}))),this.doSignOut=function(){return t.auth.signOut()},this.sessions=function(){return t.firestore().collection("sessions")},this.session=function(e){return t.sessions().doc(e)},g.a.initializeApp(h),this.auth=g.a.auth(),this.firestore=g.a.firestore},O=a(23);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var y=function(e){var t=Object(n.useContext)(m),a=Object(n.useState)(!1),r=Object(u.a)(a,2),o=r[0],c=r[1],i=Object(n.useState)(!0),s=Object(u.a)(i,2),l=s[0],d=s[1],p=Object(n.useState)([]),f=Object(u.a)(p,2),b=f[0],E=f[1];return Object(n.useEffect)((function(){var a=t.firestore().collection(e).onSnapshot((function(e){var t=[];e.forEach((function(e){t.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(a,!0).forEach((function(t){Object(O.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({id:e.id},e.data()))})),d(!1),E(t)}),(function(e){d(!1),c(e)}));return function(){return a()}}),[t,e]),{collection:b,error:o,isLoading:l}};function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var C=function(e){var t=Object(n.useContext)(m),a=Object(n.useState)(!1),r=Object(u.a)(a,2),o=r[0],c=r[1],i=Object(n.useState)(!0),s=Object(u.a)(i,2),l=s[0],d=s[1],p=Object(n.useState)(null),f=Object(u.a)(p,2),b=f[0],E=f[1];return Object(n.useEffect)((function(){var a=t.firestore().doc(e).onSnapshot((function(e){d(!1),E(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){Object(O.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({id:e.id},e.data()))}),(function(e){d(!1),c(e)}));return function(){return a()}}),[t,e]),{error:o,isLoading:l,doc:b}},k=v,_=function(){var e=Object(n.useContext)(m),t=Object(n.useState)((function(){var t=e.auth.currentUser;return{initializing:!t,user:t}})),a=Object(u.a)(t,2),r=a[0],o=a[1];function c(e){o({initializing:!1,user:e})}return Object(n.useEffect)((function(){var t=e.auth.onAuthStateChanged(c);return function(){return t()}}),[e]),r},x="/home",S=function(e){return"/session/".concat(e)},P=function(e,t){var a=Object(n.useContext)(m);Object(n.useEffect)((function(){var n=a.auth.onAuthStateChanged((function(a){e(a)||t.push("/")}));return function(){return n()}}),[a,e])},A={userIsSignedIn:function(e){return!!e}},D=a(131),L=a(130),I=a(124),R=a(126),N=a(116),z=Object(s.e)((function(e){var t=e.title,a=e.match,n=e.history,o=e.children,c=a.path!==x;return r.a.createElement(I.a,{full:!0},r.a.createElement(R.a,{fill:!0,align:"start",background:"light-4",pad:"small"},r.a.createElement(R.a,{direction:"row"},c&&r.a.createElement(R.a,{justify:"center",pad:"small"},r.a.createElement(L.a,{onClick:function(){return n.push(x)},icon:r.a.createElement(N.a,{color:"accent-2"})})),r.a.createElement(D.a,null,t)),o))})),B=function(){var e=Object(f.a)(p.a.mark((function e(t,a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.doSignIn();case 2:a.push(x);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),T=function(e){e.push(x)},H=function(e){var t=e.history,a=Object(n.useContext)(l),o=Object(n.useContext)(m);return r.a.createElement(z,null,r.a.createElement(D.a,null,"Welcome to planning poker ",a?a.displayName:""),a&&r.a.createElement(L.a,{primary:!0,label:"Start",onClick:T.bind(void 0,t)}),!a&&r.a.createElement(L.a,{primary:!0,label:"Sign in",onClick:B.bind(void 0,o,t)}))},W=a(129),F=a(122);var U=function(e){var t=e.session;return r.a.createElement(W.a,{size:"small"},"Created by ",t.createdBy," ",t.dateCreated&&"".concat(Object(F.a)(t.dateCreated.toDate(),new Date)," ago"))},J=a(117),V=a(118),G=[1,2,5,8,13];var K=function(e){var t=e.session,a=Object(n.useContext)(m),o=Object(n.useContext)(l),c=t.users&&t.users.includes(o.displayName),i=t.votes&&t.votes[o.displayName];return r.a.createElement(R.a,{align:"start",gap:"small",background:"neutral-3",pad:"small"},r.a.createElement(D.a,{level:"2",margin:"none",size:"small"},"Your vote"),c&&r.a.createElement(R.a,{gap:"xxsmall",direction:"row"},G.map((function(e){return r.a.createElement(L.a,{key:"estimate_".concat(e),label:e,disabled:i===e,onClick:function(){return n=e,void a.session(t.id).update(Object(O.a)({},"votes.".concat(o.displayName),n));var n}})}))),c?r.a.createElement(L.a,{color:"accent-3",label:"Leave session",onClick:function(){a.session(t.id).update(Object(O.a)({users:a.firestore.FieldValue.arrayRemove(o.displayName)},"votes.".concat(o.displayName),a.firestore.FieldValue.delete()))},icon:r.a.createElement(J.a,null)}):r.a.createElement(L.a,{primary:!0,label:"Join session",onClick:function(){a.session(t.id).update({users:a.firestore.FieldValue.arrayUnion(o.displayName)})},icon:r.a.createElement(V.a,null)}))},M=a(128),Y=a(119);var $=function(e){var t=e.session,a=Object(n.useContext)(m),o=Object(n.useContext)(l);return r.a.createElement(R.a,{align:"start",gap:"small",background:"neutral-2",pad:"small"},r.a.createElement(D.a,{level:"2",margin:"none",size:"small"},"Results"),r.a.createElement(W.a,null,"Results for each user"),r.a.createElement(M.a,{checked:t.reveal,label:"Reveal results",onChange:function(e){var n=e.target.checked;a.session(t.id).update({reveal:n})}}),r.a.createElement(R.a,{direction:"row",justify:"center",gap:"small"},t.users&&t.users.map((function(e){var a=function(e){return t.votes&&t.votes[e]}(e);return r.a.createElement(R.a,{key:"session_user_".concat(e),direction:"row",border:!0},r.a.createElement(R.a,{pad:"xsmall",background:e===o.displayName?"accent-1":"accent-4"},r.a.createElement(W.a,{size:"large"},e)),a&&r.a.createElement(R.a,{pad:"xxsmall",justify:"center",width:"xxsmall",align:"center"},t.reveal?r.a.createElement(W.a,{size:"large",weight:"bold"},a):r.a.createElement(Y.a,null)))}))))},q=function(e){var t=e.history,a=e.match.params.id;P(A.userIsSignedIn,t);var n=C("sessions/".concat(a)),o=n.doc,c=n.isLoading,i=n.error,s=o?o.title:c?"Loading...":i?"Error":"";return r.a.createElement(z,{title:s},o&&r.a.createElement(R.a,{gap:"small"},r.a.createElement(U,{session:o}),r.a.createElement(R.a,{direction:"row",gap:"small"},r.a.createElement(K,{session:o}),r.a.createElement($,{session:o}))))},Q=a(127),X=a(121),Z=a(123),ee=a(81),te=a(82),ae=a(84),ne=a(37),re=a(83),oe=a(125),ce=function(e){function t(){return Object(b.a)(this,t),Object(ae.a)(this,Object(ne.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(te.a)(t,[{key:"componentDidMount",value:function(){this.startAutoHideTimeout()}},{key:"componentWillUnmount",value:function(){this.timeoutAutoHide&&clearTimeout(this.timeoutAutoHide)}},{key:"startAutoHideTimeout",value:function(){var e=this.props,t=e.duration,a=e.onClose;t&&(this.timeoutAutoHide=setTimeout((function(){a()}),1e3*t))}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.modal,n=e.position,o=e.full,c=Object(ee.a)(e,["children","modal","position","full"]);return r.a.createElement(oe.a,Object.assign({position:n||"top",full:o,modal:a,margin:"none",responsive:!0,plain:!a},c),t)}}]),t}(n.Component),ie=function(e){var t=e.onClose,a=Object(n.useState)(""),o=Object(u.a)(a,2),c=o[0],i=o[1],s=Object(n.useContext)(m),d=Object(n.useContext)(l);function b(){return(b=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.sessions().add({title:c,createdBy:d.displayName,dateCreated:new Date});case 2:t();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(ce,{position:"center",modal:!0},r.a.createElement(R.a,{align:"center"},r.a.createElement(R.a,{width:"medium",pad:"small",round:!1},r.a.createElement(D.a,{level:"4",margin:"small"},"Please enter a title"),r.a.createElement(Z.a,{autoFocus:!0,placeholder:"type here",value:c,onChange:function(e){return i(e.target.value)}})),r.a.createElement(R.a,{width:"medium",margin:"none",direction:"row"},r.a.createElement(R.a,{basis:"1/2"},r.a.createElement(L.a,{plain:!0,color:"dark-1",onClick:function(){return b.apply(this,arguments)}},r.a.createElement(R.a,{pad:"small",align:"center",background:"status-ok"},"Accept"))),r.a.createElement(R.a,{basis:"1/2"},r.a.createElement(L.a,{plain:!0,color:"dark-1",onClick:t},r.a.createElement(R.a,{pad:"small",align:"center",background:"status-error"},"Reject"))))))},se=function(e){var t=e.onNavigateToSession,a=Object(n.useState)(!1),o=Object(u.a)(a,2),c=o[0],i=o[1],s=y("sessions"),l=s.collection,m=s.error;return s.isLoading?r.a.createElement(D.a,{level:"4"},"Loading..."):m?r.a.createElement(D.a,{level:"4"},"Error loading sessions"):r.a.createElement(Q.a,{align:"start",gap:"small"},r.a.createElement(R.a,{align:"start"},r.a.createElement(L.a,{icon:r.a.createElement(X.a,null),label:"Create New Session",onClick:function(){return i(!0)},color:"accent-4",primary:!0})),r.a.createElement(R.a,{gap:"small",direction:"row-responsive"},l.map((function(e){return r.a.createElement(R.a,{key:"sessionlist_".concat(e.id),background:"neutral-2",pad:"small",onClick:function(){return t(e.id)}},r.a.createElement(D.a,{level:"5",margin:"small"},e.title),r.a.createElement(W.a,{size:"xsmall"},"Created by ",e.createdBy," ",e.dateCreated&&"".concat(Object(F.a)(e.dateCreated.toDate(),new Date)," ago")))}))),c&&r.a.createElement(ie,{onClose:function(){return i(!1)}}))},le=function(e){var t=e.history;return P(A.userIsSignedIn,t),r.a.createElement(z,{title:"All Sessions"},r.a.createElement(se,{onNavigateToSession:function(e){t.push(S(e))}}))},ue=function(){var e=_();return r.a.createElement(l.Provider,{value:e.user},r.a.createElement(i.a,null,r.a.createElement(s.a,{exact:!0,path:"/",component:H}),r.a.createElement(s.a,{path:x,component:le}),r.a.createElement(s.a,{path:"/session/:id",component:q})))};c.a.render(r.a.createElement(m.Provider,{value:new k},r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},88:function(e,t,a){e.exports=a(109)},93:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.422ffd98.chunk.js.map